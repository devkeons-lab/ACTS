# 코인 자동 매매 시스템 구현 계획

- [x] 1. 프로젝트 초기 설정 및 구조 생성


  - 백엔드와 프론트엔드 폴더 구조 생성
  - 각 서버별 package.json 및 TypeScript 설정
  - Docker Compose 개발 환경 구성 (MySQL, Redis)
  - 환경 변수 설정 파일 생성
  - _요구사항: 1.1, 8.1, 8.2_


- [x] 2. 데이터베이스 및 Redis 설정


- [ ] 2.1 MySQL 데이터베이스 스키마 생성
  - users, trade_logs, system_settings 테이블 생성
  - 인덱스 및 외래키 제약조건 설정
  - 초기 데이터 시드 스크립트 작성


  - _요구사항: 1.1, 2.2, 3.2_

- [ ] 2.2 Redis 연결 및 데이터 구조 설정
  - Redis 클라이언트 연결 설정

  - 캔들 데이터 저장 구조 구현
  - Redis 연결 오류 처리 및 재연결 로직
  - _요구사항: 4.1, 4.2, 4.4_

- [x] 3. 데이터 수집 서버 구현

- [x] 3.1 Bybit REST API 연동 및 초기 데이터 수집


  - Bybit REST API 클라이언트 설정
  - BTCUSDT 1분봉 5000개 데이터 수집 기능
  - Redis에 캔들 데이터 저장 로직 (LPUSH)
  - 데이터 수집 오류 처리 및 재시도 로직
  - _요구사항: 4.1_





- [x] 3.2 Bybit WebSocket 실시간 데이터 수신

  - WebSocket 연결 및 실시간 캔들 데이터 수신


  - 새로운 캔들 데이터 Redis 추가 (LPUSH + LTRIM)
  - WebSocket 연결 끊김 감지 및 자동 재연결
  - 실시간 데이터 수신 상태 모니터링
  - _요구사항: 4.2, 4.4_



- [ ] 4. API 서버 기본 구조 구현
- [ ] 4.1 Express 서버 및 미들웨어 설정
  - Express 서버 기본 설정
  - CORS, 보안 헤더, 로깅 미들웨어 설정
  - 오류 처리 미들웨어 구현

  - 헬스체크 엔드포인트 구현


  - _요구사항: 8.2, 8.4_

- [ ] 4.2 사용자 인증 시스템 구현
  - 회원가입 API (POST /api/auth/register)
  - 로그인 API (POST /api/auth/login) 


  - JWT 토큰 생성 및 httpOnly 쿠키 설정
  - 인증 미들웨어 구현
  - 로그아웃 API (POST /api/auth/logout)
  - _요구사항: 1.1, 1.2, 1.3, 1.4_




- [ ] 5. API 키 관리 기능 구현
- [ ] 5.1 API 키 암호화 및 저장 시스템
  - AES256 암호화/복호화 유틸리티 함수
  - API 키 저장 API (POST /api/apikey)

  - 저장된 API 키 조회 API (GET /api/apikey) - 마스킹 처리


  - API 키 수정/삭제 API
  - _요구사항: 2.2, 8.1_

- [x] 5.2 Bybit API 키 유효성 검증

  - Bybit API 키 유효성 검증 로직


  - 테스트 API 호출을 통한 권한 확인
  - 검증 실패 시 구체적인 오류 메시지 제공
  - API 키 검증 결과 프론트엔드 전달
  - _요구사항: 2.1, 2.4_



- [ ] 6. 캔들 데이터 API 구현
- [ ] 6.1 캔들 데이터 조회 API 구현
  - Redis에서 캔들 데이터 조회 API (GET /api/kline)
  - 쿼리 파라미터 검증 (symbol, interval, count)
  - 캔들 데이터 포맷팅 및 응답


  - 캐싱 및 성능 최적화
  - _요구사항: 4.3_

- [x] 7. 자동매매 설정 관리 API

- [x] 7.1 사용자 설정 CRUD API 구현


  - 설정 조회 API (GET /api/settings)
  - 설정 저장 API (POST /api/settings)
  - 위험도, 레버리지, 자동매매 활성화 설정
  - 커스텀 GPT 프롬프트 저장 기능
  - _요구사항: 3.1, 3.2, 3.3, 3.4_



- [ ] 8. GPT 기반 자동매매 서버 구현
- [ ] 8.1 GPT API 연동 및 프롬프트 시스템
  - OpenAI GPT API 클라이언트 설정

  - 캔들 데이터 기반 분석 프롬프트 생성


  - GPT 응답 파싱 및 검증 로직
  - 커스텀 프롬프트 지원 기능
  - _요구사항: 5.2_

- [x] 8.2 주기적 자동매매 실행 시스템


  - node-cron을 이용한 5분 주기 스케줄러
  - Redis에서 최신 30개 캔들 데이터 조회
  - auto_trade_enabled=true 사용자 필터링
  - 사용자별 위험도 및 레버리지 설정 적용

  - _요구사항: 5.1, 5.3_



- [ ] 8.3 Bybit 자동매매 주문 실행
  - 사용자별 API 키 복호화 및 Bybit 클라이언트 생성
  - GPT 판단에 따른 매수/매도 주문 실행

  - 주문 성공/실패 결과 처리


  - 거래 로그 저장 (trade_logs 테이블)
  - _요구사항: 5.3, 5.4_

- [x] 9. 프론트엔드 기본 구조 및 인증


- [x] 9.1 Next.js 프로젝트 설정 및 기본 레이아웃


  - Next.js 14 App Router 프로젝트 생성
  - Tailwind CSS 및 shadcn/ui 설정
  - 기본 레이아웃 및 네비게이션 컴포넌트
  - 반응형 디자인 기본 구조
  - _요구사항: 6.1_

- [ ] 9.2 인증 페이지 구현
  - 로그인 페이지 (/auth/login)
  - 회원가입 페이지 (/auth/register)
  - JWT 쿠키 기반 인증 상태 관리
  - 인증 가드 및 리다이렉트 로직
  - _요구사항: 1.1, 1.2, 1.3_

- [ ] 10. 메인 대시보드 구현
- [ ] 10.1 실시간 차트 컴포넌트 구현
  - lightweight-charts 라이브러리 설정
  - 실시간 BTCUSDT 캔들 차트 렌더링
  - 차트 데이터 자동 업데이트 (SWR 또는 polling)
  - 차트 인터랙션 및 줌 기능
  - _요구사항: 6.1, 6.4_

- [ ] 10.2 자동매매 제어 패널 구현
  - 자동매매 활성화/비활성화 토글
  - 위험도 설정 슬라이더 (low/medium/high)
  - 현재 설정 상태 표시
  - 실시간 상태 업데이트
  - _요구사항: 6.2, 6.3_

- [ ] 11. API 키 관리 페이지 구현
- [ ] 11.1 API 키 등록 및 관리 폼
  - API 키 입력 폼 (/dashboard/api-key)
  - 실시간 유효성 검증 및 피드백
  - 저장된 API 키 마스킹 표시
  - API 키 수정/삭제 기능
  - _요구사항: 2.1, 2.3, 2.4_

- [ ] 12. 설정 관리 페이지 구현
- [ ] 12.1 자동매매 설정 페이지
  - 위험도 설정 인터페이스 (/dashboard/settings)
  - 최대 레버리지 설정
  - 커스텀 GPT 프롬프트 편집기
  - 설정 저장 및 실시간 반영
  - _요구사항: 3.1, 3.2, 3.3, 3.4_

- [ ] 13. 거래 로그 페이지 구현 (선택사항)
- [ ] 13.1 거래 내역 조회 및 표시
  - 거래 로그 테이블 컴포넌트 (/dashboard/logs)
  - GPT 판단 결과 및 주문 실행 내역 표시
  - 날짜별 필터링 및 페이지네이션
  - 거래 상세 정보 모달
  - _요구사항: 7.1, 7.2, 7.3, 7.4_

- [ ] 14. 시스템 통합 테스트 및 최적화
- [ ] 14.1 전체 시스템 통합 테스트
  - 데이터 수집 → Redis 저장 → API 조회 플로우 테스트
  - 회원가입 → API 키 등록 → 자동매매 설정 E2E 테스트
  - GPT 분석 → 자동매매 실행 통합 테스트
  - 오류 상황 처리 테스트
  - _요구사항: 모든 요구사항 통합 검증_

- [ ] 14.2 성능 최적화 및 보안 강화
  - Redis 캔들 데이터 조회 성능 최적화
  - API 응답 시간 최적화
  - 보안 헤더 및 HTTPS 설정
  - 로그 시스템 및 모니터링 구현
  - _요구사항: 8.1, 8.2, 8.3, 8.4_

- [ ] 15. 배포 환경 구성
- [ ] 15.1 프로덕션 배포 설정
  - Docker 컨테이너 이미지 생성
  - PM2 프로세스 관리 설정
  - Nginx 리버스 프록시 설정
  - SSL 인증서 적용
  - 환경별 설정 파일 분리
  - _요구사항: 8.2, 8.3_

- [ ] 15.2 모니터링 및 로깅 시스템
  - 서버 상태 모니터링 대시보드
  - 거래 실행 로그 모니터링
  - 오류 알림 시스템 구성
  - 백업 및 복구 절차 수립
  - _요구사항: 8.4_